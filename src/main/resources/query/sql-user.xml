<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.meonjicompany.planning.jplanningbackend.mapper.UserMapper">
    <!-- 회원가입 -->
    <insert id="registerUser" parameterType="com.meonjicompany.planning.jplanningbackend.dto.UserDTO">
        INSERT INTO user (user_email, user_nickname, user_created_date) VALUES (#{userEmail},#{userNickname}, NOW());
    </insert>
    <!--사용자 id 불러오기-->
    <select id="roadUserId" resultType="int">
        select user_id from user where user_email = #{user_email}
    </select>
    <!-- 계획 저장 : DB TABLE - plan -->
    <insert id="savePlan" parameterType="com.meonjicompany.planning.jplanningbackend.dto.PlanSaveDTO">
        insert into plan (user_id, plan_title, plan_date, plan_create_date) values (#{userId}, #{planTitle}, #{planDate}, NOW())
    </insert>
    <!-- 계획 id 불러오기 -->
    <select id="roadPlanId" resultType="int">
        select plan_id from plan where plan_title = #{planTitle}
    </select>
    <!-- 상세 계획 저장 : DB TABLE - piece -->
    <insert id="savePiece" parameterType="com.meonjicompany.planning.jplanningbackend.dto.PieceSaveDTO">
        insert into piece (plan_id, piece_time, piece_contents) values (#{planId},#{pieceTime},#{pieceContents})
    </insert>
    <!-- 계획 불러오기 -->
    <select id="roadPlan" parameterType="int" resultType="com.meonjicompany.planning.jplanningbackend.dto.PlanRoadDTO">
        select plan_id, plan_title, plan_date from plan where user_id = #{userId} ORDER BY plan_id
    </select>
</mapper>